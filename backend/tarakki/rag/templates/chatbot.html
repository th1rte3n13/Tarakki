{% extends 'dashboard/dash-base.html' %}

{% block content %}
<div class="bg-white p-6 rounded-lg shadow-lg flex flex-col h-full">
    <h2 class="text-xl font-bold mb-4">Chatbot</h2>

    <div id="chat-history" class="flex-grow overflow-y-auto border rounded p-4 mb-4 h-96">
        <h3 class="text-lg font-semibold mb-2">Chat History</h3>
        {% if user_input and bot_response %}
            <div class="chat-message user mb-2">
                <p class="bg-blue-100 text-blue-800 p-2 rounded-lg inline-block"><strong>You:</strong> {{ user_input }}</p>
            </div>
            <div class="chat-message bot mb-2">
                <p class="bg-gray-100 text-gray-800 p-2 rounded-lg inline-block"><strong>Bot:</strong> {{ bot_response }}</p>
            </div>
        {% endif %}
    </div>

    <form method="post" 
        hx-post="{% url 'chat' %}" 
        hx-target="#chat-history" 
        hx-swap="beforeend" 
        class="flex flex-col" 
        hx-on:htmx:after-request="document.getElementById('user_input').value = ''">
        {% csrf_token %}
        <label for="user_input" class="mb-2">Your Message:</label>
        <input type="text" id="user_input" name="user_input" class="border rounded p-2 w-full mb-4" required>
        <button  type="submit" class="bg-blue-500 text-white p-2 rounded">Send</button>
    </form>
</div>

<script>
    function clearInput() {
      document.getElementById('user_input').value = '';
    }
  </script>
{% endblock %}